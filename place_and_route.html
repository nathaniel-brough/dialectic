<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Automatic place and route - dialectic</title>
                

        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

                <link rel="icon" href="favicon.svg">
                        <link rel="shortcut icon" href="favicon.png">
                <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
                <link rel="stylesheet" href="css/print.css" media="print">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../index.html">Introduction</a></li><li class="chapter-item expanded "><a href="technical_overview.html"><strong aria-hidden="true">1.</strong> Technical overview</a></li><li class="chapter-item expanded "><a href="analysis_preconditions.html"><strong aria-hidden="true">2.</strong> Analysis preconditions</a></li><li class="chapter-item expanded "><a href="behavioral_definitions.html"><strong aria-hidden="true">3.</strong> Behavioral definitions</a></li><li class="chapter-item expanded "><a href="construct_bom.html"><strong aria-hidden="true">4.</strong> Constructing a BOM</a></li><li class="chapter-item expanded "><a href="generating_a_netlist.html"><strong aria-hidden="true">5.</strong> Generating a netlist</a></li><li class="chapter-item expanded "><a href="place_and_route.html" class="active"><strong aria-hidden="true">6.</strong> Automatic place and route</a></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                                            </div>

                    <h1 class="menu-title">dialectic</h1>

                    <div class="right-buttons">
                                                <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                                                                        
                    </div>
                </div>

                                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="automatic-place-and-route"><a class="header" href="#automatic-place-and-route">Automatic place and route</a></h1>
<blockquote>
<p>If you think that you could improve or feel like I've missed something
important this page feel free to contact me under the
<a href="https://github.com/silvergasp/dialectic/discussions">discussions tab</a>. Though
keep in mind that this description is far from complete.</p>
</blockquote>
<p>It's worth pointing out that the PCB layout community is understandably jaded
when it comes to auto-routing/placement. This comes from a long history of
sub-par auto-routers. I personally have used commercial auto-routers and had
them absolutely butcher my layout, ripping up more traces than it routed. So I
am approaching this problem with equal parts optimism and deep shades of jade.</p>
<p>Auto-routing is hard! A quick read over the
<a href="https://en.wikipedia.org/wiki/Routing_(electronic_design_automation)">Wikipedia page</a>
describing auto-routing and you'll see phrases like;</p>
<blockquote>
<p>&quot;Almost every problem associated with routing is known to be intractable.&quot;</p>
</blockquote>
<p>However the fact that these problems are 'intractable' is no excuse for poor
performance from an auto-router. After all we are able to route circuits
manually, usually with 'better' results.</p>
<p>So if we can manually route a circuit there is no reason why we can't develope
an algorithm to do the same thing automatically. After all we didn't evolve
to layout circuits so we don't have some fundamental evolutionary advantage that
we developed over 10,000s of years that a CPU does not.</p>
<p>So why don't auto-routers perform up to our expectations? I don't have all the
answers, but I have a set of hunches (which are open challenge).</p>
<ol>
<li>Auto-routers don't have the same level of control as what we do. e.g. usually
they can't pin-swap, they can't move parts around (e.g. to make more space
for vias or length matching). They can't completely change package if a
different footprint would work better.</li>
<li>We are biased to prefer manually routed circuits. In some cases auto-routers
<em>may</em> be performing as good as our hand routed designs but we just don't
recognize that because we are trained to like our circuits routed in a
particular way.</li>
<li>Typically engineers will route a PCB using 'rules of thumb', which are
<strong>usually</strong> simplifications of more complex physics. Often search algorithms
(i.e. auto-routers) will quickly find edge cases and loop holes in simplified
rules. Therefore we should give auto-routers more information as to the
underlying physics associated with electronics.</li>
<li>We don't give auto-routers enough information about what we want our routing
to look like. Without a suitable set of constraints we can't expect an
auto-router to route a decent circuit. In other words garbage in garbage out.</li>
</ol>
<h2 id="proposed-solution-for-dialectic-auto-routing"><a class="header" href="#proposed-solution-for-dialectic-auto-routing">Proposed solution for dialectic auto-routing</a></h2>
<p>The current proposal for auto-routing is to use a multi-stage iterative approach.
giving the auto-router full controllability over the design process. So simplified
pipeline would look something like the following.</p>
<pre><code class="language-mermaid">graph TB
S[Start] --&gt; A
style S fill:#f9f
A[Auto-place parts] --&gt; B
subgraph Attempt place and route N times
B[Auto-route] --&gt; |Failure| C
C[Slightly move parts] --&gt; B
end
B --&gt; |Failure| E
E[Modify part variants] --&gt; A
B --&gt; |Success| D
D[Done]
</code></pre>
<h3 id="routing-algorithm"><a class="header" href="#routing-algorithm">Routing algorithm</a></h3>
<p>Routing algorithms started off fairly simple. With the first auto-router using
Lee's maze solving algorithm. Which is essentially a grid based breadth first
search with backtracking. Today most high end auto-routers use an algorithm
based on topological auto-routing which tends to work better for high-density
circuits.</p>
<h4 id="potential-improvements-on-topological-routing"><a class="header" href="#potential-improvements-on-topological-routing">Potential improvements on topological-routing</a></h4>
<p>There are a couple of improvements that can be made to typical auto-routers;</p>
<ol>
<li>Return path routing</li>
</ol>
<h5 id="return-path-routing"><a class="header" href="#return-path-routing">Return path routing</a></h5>
<p>Currently (at least in the auto-routers I've used) there is very little effort
put into routing/managing the signal return path. What I'd like to propose is
that each signal be treated as a set of two links (see
<a href="https://en.wikipedia.org/wiki/Link_(knot_theory)">topological link/knot theory</a>). At least
one of the two links with either a ground <strong>or</strong> power return path must be
routed into the board. By simultaneously routing both the signal and return path
you can minimize EMI and reduce signal integrity. While a power and/or ground
planes may still be used it will still likely be useful to keep track of your
routed return paths through those planes as intersections on the return path
routing may result in increased current density.</p>
<pre><code class="language-mermaid">graph LR

A[Pin 1] --&gt;|Signal| B[Pin 2]
B --&gt;|Vdd return path| A
B --&gt;|GND return path| A
</code></pre>
<p>This approach has the most potential when routing 1-2 layer boards. For example
a ground trace can be routed parallel to signal traces to minimize EMI and
maximize signal integrity.</p>
<p>There is also significant gains to be made in very high speed designs, where
signal integrity and EMI are much more difficult to manage.</p>
<h2 id="other-constraints"><a class="header" href="#other-constraints">Other constraints</a></h2>
<p>In many cases there will be other constraints that need to be met for the circuit
to work as part of a larger electromechanical design e.g. connector locations
PCB shape etc. How these constraints are applied is yet to be determined.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                                                    <a rel="prev" href="generating_a_netlist.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                                    <a rel="prev" href="generating_a_netlist.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                
                            </nav>

        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
        
                <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
                <script type="text/javascript" src="mermaid.min.js"></script>
                <script type="text/javascript" src="mermaid-init.js"></script>
        
        
    </body>
</html>
