<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Constructing a BOM - dialectic</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../index.html">Introduction</a></li><li class="chapter-item expanded "><a href="technical_overview.html"><strong aria-hidden="true">1.</strong> Technical overview</a></li><li class="chapter-item expanded "><a href="analysis_preconditions.html"><strong aria-hidden="true">2.</strong> Analysis preconditions</a></li><li class="chapter-item expanded "><a href="behavioral_definitions.html"><strong aria-hidden="true">3.</strong> Behavioral definitions</a></li><li class="chapter-item expanded "><a href="construct_bom.html" class="active"><strong aria-hidden="true">4.</strong> Constructing a BOM</a></li><li class="chapter-item expanded "><a href="generating_a_netlist.html"><strong aria-hidden="true">5.</strong> Generating a netlist</a></li><li class="chapter-item expanded "><a href="place_and_route.html"><strong aria-hidden="true">6.</strong> Automatic place and route</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">dialectic</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="constructing-a-bom"><a class="header" href="#constructing-a-bom">Constructing a BOM</a></h1>
<p>Now that we have defined our operational and manufacturing constraints. We can
start selecting components. At a high level this process would follow the
following approach.</p>
<ul>
<li>Pre-filtering based on manufacturing and operating constraints.</li>
<li>For each behavior find a set of components/predefined sub-circuits that meet
your needs. Narrow to single instantiate based on some heuristic.</li>
<li>Each of the narrowed components/sub-circuits have their own constraints. These
constraints should be handled recursively.</li>
<li>An end state for BOM generation is met when each recursive component has it's
requirements met.</li>
<li>Optionally create a set cost reduction passes. For example while the first
set of 'seed' components might have been chosen to be the cheapest, the sum of
their supporting parts (i.e. recursively chosen) parts maybe more expensive.</li>
</ul>
<p>This type of process predicates on having highly detailed;</p>
<ul>
<li>Footprints,</li>
<li>Component descriptions (aka schematic libraries),</li>
<li>Predefined functional sub-circuits.</li>
</ul>
<blockquote>
<p>Note: While automation is great, sometimes for very specific reasons you want
to choose a very specific part. It is the intention that it be possible to
manually override each stage/pass in this process.</p>
</blockquote>
<h2 id="pre-filtering"><a class="header" href="#pre-filtering">Pre-filtering</a></h2>
<p>Pre-filter parts database based on manufacturing and operating constraints. e.g.
The following database of resistors with the following pre-filter;</p>
<ul>
<li>Min temp: -20</li>
<li>Min copper spacing: 0.65mm</li>
</ul>
<div class="table-wrapper"><table><thead><tr><th>Value</th><th>Min temp</th><th>Package</th></tr></thead><tbody>
<tr><td>10k</td><td>-5</td><td>0402</td></tr>
<tr><td>10k</td><td>-10</td><td>0805</td></tr>
<tr><td>10k</td><td>-40</td><td>0805</td></tr>
<tr><td>11k</td><td>-40</td><td>0805</td></tr>
</tbody></table>
</div>
<p>Would be reduced to;</p>
<div class="table-wrapper"><table><thead><tr><th>Value</th><th>Min temp</th><th>Package</th></tr></thead><tbody>
<tr><td>10k</td><td>-40</td><td>0805</td></tr>
<tr><td>11k</td><td>-40</td><td>0805</td></tr>
</tbody></table>
</div>
<h2 id="behavior-matching"><a class="header" href="#behavior-matching">Behavior matching</a></h2>
<p>For each behavior search through your database of parts/predefined sub-circuits
and find a set of 'candidate' components that meet your requirements. This may
involve guiding this process of behavior down to function. e.g.</p>
<p>Using a some guiding heuristic (e.g. minimize component cost), choose a single
component/sub-circuit that meets the behavior. In some cases this can be
specialized down to a physical interface e.g.</p>
<p>A resistor with the follow constraints;</p>
<ul>
<li>Value: 10k</li>
<li>Min temperature: -20</li>
<li>Package: 0402</li>
</ul>
<p>It is not necessary to specialize down to a particular part number at this point
as there are multiple parts that can meet the 0402 physical interface. This
can only be done on parts that have the same physical footprint/interface.</p>
<p>These first set of matching components are considered 'Seeds' for the rest of
the schematic, on which the schematic will naturally grow.</p>
<h2 id="recursive-behavior-matching"><a class="header" href="#recursive-behavior-matching">Recursive behavior matching</a></h2>
<p>As previously mentioned the 'seed' components have their own set of constraints
and requirements. e.g. An accelerometer sensor chosen in the previous step may
need 1.8-3.3V to operate, therefore the next stage of the recursive matching
might involve a buck converter and/or a battery.</p>
<h2 id="bom-optimization-optional"><a class="header" href="#bom-optimization-optional">BOM optimization (Optional)</a></h2>
<p>There are many opportunities for BOM cost reduction. While each recursive stage
might be optimized for cost. This involves a greedy and non-optimal search
pattern. There are also multiple areas where constraints can be reduced to allow
for a greater range of freedom in BOM reduction. e.g. Consider 3 parts A, B and
C currently candidates for the BOM.</p>
<p><em>Part A has 2 pins</em></p>
<ul>
<li>GND</li>
<li>VDD
<ul>
<li>Requires 1.8-3.3V @ up to 50mA</li>
<li>Requires 80-200nF of capacitance for decoupling</li>
</ul>
</li>
</ul>
<p><em>Part B has 2 pins</em></p>
<ul>
<li>GND</li>
<li>VDD
<ul>
<li>Requires 3.0-3.3V @ up to 800mA</li>
<li>Requires 90-150nF of capacitance for decoupling</li>
</ul>
</li>
</ul>
<p><em>Part C has 2 pins</em></p>
<ul>
<li>GND</li>
<li>VDD
<ul>
<li>Requires 1.8-2.5V @ up to 5mA</li>
<li>Requires 90-150nF of capacitance for decoupling</li>
</ul>
</li>
</ul>
<p>It's fairly reasonable to assume that;</p>
<ul>
<li>A &amp; C can share a power rail.</li>
<li>A &amp; B can share a power rail.</li>
<li>B &amp; C cannot share a power rail.</li>
</ul>
<p>So at least two power rails will be required. However all three have a range of
capacitances that overlap such that an acceptable capacitor can be chosen for
all three reducing the unique component count. e.g. a 100nF capacitor with a 10%
tolerance will work for all three.</p>
<h2 id="example"><a class="header" href="#example">Example</a></h2>
<blockquote>
<p>Note: This example has some known issue;</p>
<ul>
<li>Doesn't address logic levels in database search.</li>
<li>Doesn't address multi-purpose pin-remapping and conflicts.</li>
<li>Doesn't address the relationship between cpu-&gt;spi_peripheral.</li>
<li>Doesn't address the relationship between firmware size and flash storage.</li>
<li>SPI bus is shared between accelerometer and display. But the count for GPIO
chip selects isn't checked.</li>
<li>Doesn't include scenarios showing when multiple components match a given
requirement.</li>
</ul>
<p>There is a bit of a balance between writing a concise example and missing
critical details. This is also a WIP and I haven't worked out all the details
yet. If you think that I've missed something important please feel free to
<a href="https://github.com/silvergasp/dialectic/issues/new/choose">open an issue</a>.
If you think that you could improve this example feel free to contact me
under the
<a href="https://github.com/silvergasp/dialectic/discussions">discussions tab</a>.</p>
</blockquote>
<p>Let's go back to our step counter, and see how this recursive component
selection might work on a simplified database of parts.</p>
<p>So let's say we start with a 'sensor to detect a step'. First we would need to
map this requirement to a physical phenomenon that can be measured. So when we
take a step with accelerate slightly forward and then accelerate slightly
backwards as our foot impacts the ground again. Not only that but we will likely
do a little bob vertically as well. So a sensor that can measure acceleration
with some post processing can count steps! Now it's likely that we will want to
constrain this further. For example we don't want a sensor that can only sample
once a second as we wouldn't be able to determine how many steps you take unless
you take less than 0.5 steps/s. So the world record for 'skips'/seconds is 9.6
skips/s. This is roughly the same motion as a step so let's use that as our
baseline. At that rate we would need at minimum 19.2Hz to prevent aliasing. But
it's likely that we would want significantly more. So let's go with 4x9.6=38.4Hz
as a minimum sampling rate.</p>
<blockquote>
<p>NOTE: there might be other was of doing this at a
later time e.g. using a ranging sensor that measures distance to the ground. So
it's still useful to keep the original abstract concept of a step counter.</p>
</blockquote>
<pre class="mermaid">graph TB
A[Sensor to detect a step]
B[Computation system to interpret sensor output]
C[Counter to keep track of steps]
D[Display to show us the step count]
style A fill:#f9f
style B fill:#f9f
style C fill:#f9f
style D fill:#f9f
</pre>
<p>So this is where we can start searching for a part in our database. To simplify
this example I've only put one sensor that will work. So find the 'Accelerometer'
sensor. So we find the part 'Accel101' that matches our sampling requirements.</p>
<pre class="mermaid">graph BT
A[Sensor to detect a step]
B[Computation system to interpret sensor output]
C[Counter to keep track of steps]
D[Display to show us the step count]
E[Accel101]--&gt;|provides|A
</pre>
<p>Now we find that 'Accel101' has requirements on it's own. Specifically it needs
power and an SPI controller. So we search for a power provider that will work
for our accelerometer and we find a battery.</p>
<pre class="mermaid">graph BT
A[Sensor to detect a step]
B[Computation system to interpret sensor output]
C[Counter to keep track of steps]
D[Display to show us the step count]
style A fill:#f9f
style B fill:#f9f
style C fill:#f9f
style D fill:#f9f

E[Accel101]--&gt;|provides acceleration|A
F[Battery]--&gt;|provides power|E
</pre>
<p>We then search for a device that can act as a SPI controller and find the
'ControlFreak1000' micro-controller.</p>
<pre class="mermaid">graph BT
A[Sensor to detect a step]
B[Computation system to interpret sensor output]
C[Counter to keep track of steps]
D[Display to show us the step count]
style A fill:#f9f
style B fill:#f9f
style C fill:#f9f
style D fill:#f9f

E[Accel101]--&gt;|provides acceleration|A
F[Battery]--&gt;|provides power|E
G[ControlFreak1000]--&gt;|provides SPI controller|E
</pre>
<p>The control freak micro-controller also by coincidence happens to provide
functionality for two more of our behavioral definitions via it's cpu;</p>
<ul>
<li>Computation system to interpret sensor output,</li>
<li>Counter to keep track of steps.</li>
</ul>
<pre class="mermaid">graph BT
A[Sensor to detect a step]
B[Computation system to interpret sensor output]
C[Counter to keep track of steps]
D[Display to show us the step count]
style A fill:#f9f
style B fill:#f9f
style C fill:#f9f
style D fill:#f9f

E[Accel101] --&gt; |provides acceleration| A
F[Battery] --&gt; |provides power| E
G[ControlFreak1000] --&gt; |provides SPI controller|E
G --&gt; |Provides computation| B
G --&gt; |Provides counter| C
</pre>
<p>The micro-controller however has a it's own requirements. Again we have to solve
the power problem. However as we've already chosen the battery, and the voltage
should work we just have to check that the battery can provide enough power for
both the accelerometer and the micro-controller at the same time. 0.1 + 0.01 &lt; 1
so we can keep the battery in our proposed BOM.</p>
<pre class="mermaid">graph BT
A[Sensor to detect a step]
B[Computation system to interpret sensor output]
C[Counter to keep track of steps]
D[Display to show us the step count]
style A fill:#f9f
style B fill:#f9f
style C fill:#f9f
style D fill:#f9f

E[Accel101] --&gt; |provides acceleration| A
F[Battery] --&gt; |provides power| E
G[ControlFreak1000] --&gt; |provides SPI controller|E
F[Battery] --&gt; |provides power| G
G --&gt; |Provides computation| B
G --&gt; |Provides counter| C
</pre>
<p>We have one final behavior that we need to meet 'Display to show us the step
count', So we search through our database and find our 'Display100' part. Again
the display requires some power, we check our current BOM to see if we have
anything that can provide that. We find the battery, we just need to check that
the battery can supply power to the micro-controller, accelerometer and display
all at once. It can so we at this point we have an automatically generated BOM,
that meets our needs.</p>
<pre class="mermaid">graph BT
A[Sensor to detect a step]
B[Computation system to interpret sensor output]
C[Counter to keep track of steps]
D[Display to show us the step count]
style A fill:#f9f
style B fill:#f9f
style C fill:#f9f
style D fill:#f9f

E[Accel101] --&gt; |provides acceleration| A
F[Battery] --&gt; |provides power| E
G[ControlFreak1000] --&gt; |provides SPI controller|E
F[Battery] --&gt; |provides power| G
G --&gt; |Provides computation| B
G --&gt; |Provides counter| C
H[Display] --&gt; |Provides display|D
G[ControlFreak1000] --&gt; |provides SPI controller|H
</pre>
<h3 id="database"><a class="header" href="#database">Database</a></h3>
<p><em>Part: ControlFreak1000</em></p>
<ul>
<li>cpu: Cortex-M0</li>
<li>Spi: Provides controller
<ul>
<li>Count: 1</li>
</ul>
</li>
<li>GPIO: Provides in or output
<ul>
<li>Count: 4</li>
</ul>
</li>
<li>Power: Requires 1.8-3.3V @ up to 100mA
<ul>
<li>Decoupling:
<ul>
<li>Count: 4</li>
<li>Value: 100-200nF</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><em>Part: Cap1</em></p>
<ul>
<li>value: 1uF,</li>
<li>tolerance: 10%,</li>
</ul>
<p><em>Part: Cap3</em></p>
<ul>
<li>value: 120nF,</li>
<li>tolerance: 10%,</li>
</ul>
<p><em>Part: Accel101</em></p>
<ul>
<li>Acceleration: Provides 1-10G 24bit 200Hz sampling rate</li>
<li>Spi: Requires controller</li>
<li>CS: Requires GPIO</li>
<li>Power: Requires 1.8-3.3V @ up to 10mA
<ul>
<li>Decoupling:
<ul>
<li>Count: 1</li>
<li>Value: 50-150nF</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><em>Part: Battery</em></p>
<ul>
<li>Provides 1.8-2.2V @ up to 1A</li>
</ul>
<p><em>Part: Display100</em></p>
<ul>
<li>Display: Provides display</li>
<li>Power: Requires 1.8-5.0V @ up to 100mA
<ul>
<li>Decoupling:
<ul>
<li>Count: 1</li>
<li>Value: 0.5-10uF</li>
</ul>
</li>
</ul>
</li>
<li>Spi: Requires controller</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="behavioral_definitions.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="generating_a_netlist.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="behavioral_definitions.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="generating_a_netlist.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript" src="mermaid.min.js"></script>
        <script type="text/javascript" src="mermaid-init.js"></script>
    </body>
</html>
